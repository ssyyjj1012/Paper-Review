
**1) Initial Seed íšë“**

IoT ì‹œì¥ì˜ ì„±ì¥ê³¼ ë³´ê¸‰ì´ í™•ëŒ€ê°€ ë˜ì—ˆëŠ”ë°, ì¼ë°˜ì ìœ¼ë¡œ ì¥ì¹˜ íŒì›¨ì–´ ë‚´ì˜ êµ¬í˜„ ê²°í•¨ìœ¼ë¡œ IoT ì·¨ì•½ì  ë°œìƒí•¨

ëŒ€ë¶€ë¶„ ì œì¡°ì—…ì²´ëŠ” ì œí’ˆ íŒì›¨ì–´ë¥¼ ê³µê°œí•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì½”ë“œ ê¸°ë°˜ ë™ì  ë¶„ì„ ë°©ë²•ì„ ìˆ˜í–‰í•˜ê¸° ì–´ë ¤ì›€

IoT ì¥ì¹˜ëŠ” ì¸í„°ë„·ê³¼ í†µì‹ í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ í¬í•¨í•˜ì—¬ ë„¤íŠ¸ì›Œí¬ í†µì‹ ì„ í†µí•´ ì¥ì¹˜ íŒì›¨ì–´ë¥¼ í…ŒìŠ¤íŠ¸ í•  ìˆ˜ ìˆìŒ

-ì‹¤í–‰ ì¤‘ ì¶©ëŒì´ ë°œìƒí•˜ê±°ë‚˜, ë¹„ì •ìƒì ì¸ ë©”ì‹œì§€ë¥¼ ì¬ì „ì†¡í•˜ë„ë¡ ì¥ì¹˜ê°€ PUSHë˜ëŠ” ê²½ìš° 

ë„¤íŠ¸ì›Œí¬ í†µì‹ ì„ ì‚¬ìš©í•˜ì—¬ IoT ì¥ì¹˜ì˜ íŒì›¨ì–´ Fuzzingì˜ ì–´ë ¤ì›€ì´ ì¡´ì¬í•¨

1) ì¥ì¹˜ì—ì„œ ë‚´ë¶€ ì‹¤í–‰ì •ë³´ë¥¼ ì–»ì„ ìˆ˜ ì—†ìŒ

- Mutaion Seed ì„ íƒì´ Randomì´ë¼, Mutation ì „ëµ ìµœì í™”ê°€ ì–´ë ¤ì›€

2) ì…ë ¥ì— ëŒ€í•´ ì—„ê²©í•œ ë¬¸ë²•ì„ ì ìš©

- Random Mutationì— ì˜í•´ ìƒì„±ëœ ëŒ€ë¶€ë¶„ì˜ ë©”ì‹œì§€ëŠ” ì…ë ¥ êµ¬ë¬¸ ê·œì¹™ ìœ„ë°˜ ì²˜ë¦¬ê°€ ë¨
- ì‹¤í–‰ë˜ê¸° ì „, íŒì›¨ì–´ì˜ êµ¬ë¬¸ ìœ íš¨ì„± ê²€ì‚¬ ì¤‘ ê±°ë¶€ê°€ ë˜ëŠ” ê²ƒì„

3) ë¹„í‘œì¤€ í†µì‹  í˜•ì‹ ì‚¬ìš©

- ë¬¸ë²• ê¸°ë°˜ Mutation ì „ëµì€ ì…ë ¥ ìš”êµ¬ ì‚¬í•­ì„ ì¶©ì¡±í•˜ëŠ” ë©”ì‹œì§€ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŒ

### **Challenge**

**1) FeedBack Mechanism ë¶€ì¡±**

- íŒì›¨ì–´ì˜ ë‚´ë¶€ ì‹¤í–‰ ì •ë³´ë¥¼ ì–»ëŠ” ê²ƒì€ ê±°ì˜ ë¶ˆê°€ëŠ¥
- IoT ì¥ì¹˜ì—ì„œ í”¼ë“œë°±ì„ ì–»ê³  ë©”ì‹œì§€ ìƒì„± í”„ë¡œì„¸ìŠ¤ë¥¼ ìµœì í™”í•˜ê¸° ìœ„í•œ ê²½ëŸ‰ ì†”ë£¨ì…˜ í•„ìš”í•¨

**2) ë‹¤ì–‘í•œ ë©”ì‹œì§€ í˜•ì‹**

- ë‹¤ì–‘í•œ ì¥ì¹˜ì— ì ìš©ë˜ê¸° ìœ„í•´ì„œ ì›ì‹œ ë©”ì‹œì§€ì—ì„œ í˜•ì‹ì„ ìœ ì¶”í•´ì•¼ í•¨

**3) Randomness of Response**

- ì‘ë‹µ ë©”ì‹œì§€ì—ëŠ” íƒ€ì„ìŠ¤íƒ¬í”„/í† í°ê³¼ ê°™ì€ ì„ì˜ì˜ ìš”ì†Œê°€ í¬í•¨ë  ìˆ˜ ìˆìŒ
- ì´ëŠ” ë™ì¼í•œ ë©”ì‹œì§€ì— ë‹¤ë¥¸ ì‘ë‹µì„ ìƒì„±í•˜ê³  í¼ì§• íš¨ìœ¨ì„±ì„ ê°ì†Œì‹œí‚´

---

### **IoT íŒì›¨ì–´ì˜ ì·¨ì•½ì ì„ íƒì§€í•˜ê¸° ìœ„í•œ ë¸”ë™ë°•ìŠ¤ IoT Fuzzingì¸ Snipuzzë¥¼ ì œì•ˆí•¨**

- IoT ì¥ì¹˜ì˜ í”¼ë“œë°±ìœ¼ë¡œ **ì‘ë‹µ ë©”ì‹œì§€ë¥¼ í™œìš©í•˜ì—¬ Snippet ê¸°ë°˜ Mutation Strategy**ë¥¼ êµ¬í˜„í•¨
    - ë©”ì‹œì§€ì˜ ë°”ì´íŠ¸ë¥¼ í•˜ë‚˜ì”© ë³€ê²½í•˜ì—¬ Probe Messageë¥¼ ìƒì„±í•˜ê³ , ì¥ì¹˜ì—ì„œ ìˆ˜ì§‘ëœ í•´ë‹¹ ì‘ë‹µì„ ë¶„ë¥˜í•¨
    - Messageì—ì„œ ë™ì¼í•œ ì—­í• ì„ í•˜ëŠ” ì¸ì ‘í•œ ë°”ì´íŠ¸ëŠ” Mutationì˜ ê¸°ë³¸ ë‹¨ìœ„ì¸ Initial Message Snippetì„ í˜•ì„±í•¨
- **ìœ ì‚¬ì„± ì ìˆ˜ ë° ê³„ì¸µì  í´ëŸ¬ìŠ¤í„°ë§ ì „ëµ**ì„ í™œìš©í•¨
    - Mutation Stragtegyë¥¼ ìµœì í™”, Randomness of Response Message ë° íŒì›¨ì–´ ë‚´ë¶€ ë©”ì»¤ë‹ˆì¦˜ìœ¼ë¡œ ì¸í•œ Categoryì˜ ì˜¤ë¶„ë¥˜ ê°ì†Œ
- ë”°ë¼ì„œ, IoT ì¥ì¹˜ì˜ ë¬¸ë²• ê·œì¹™ ë° ë‚´ë¶€ ì‹¤í–‰ ì •ë³´ì˜ ì§€ì› ì—†ì´ IoT ì¥ì¹˜ì˜ íŒì›¨ì–´ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆìŒ

### Contribution

**1) Message snippet inference mechanism**

- IoT ì¥ì¹˜ì˜ ì‘ë‹µì€ íŒì›¨ì–´ ì½”ë“œ ì‹¤í–‰ ê²½ë¡œì™€ ê´€ë ¨, ì‘ë‹µì„ ê¸°ë°˜ìœ¼ë¡œ message snippetê³¼ íŒì›¨ì–´ì˜ ì½”ë“œ ì‹¤í–‰ ê²½ë¡œ ê°„ì˜ ê´€ê³„ ì¶”ë¡ 

**2) More effective IoT fuzzing**

- ì‘ë‹µ ì¹´í…Œê³ ë¦¬ì˜ ìˆ˜ëŠ” íŒì›¨ì–´ì˜ ì½”ë“œ ì‹¤í–‰ ê²½ë¡œ ìˆ˜ì™€ ì–‘ì˜ ìƒê´€ê´€ê³„

**3) Implementation and vulnerability findings**

- Snipuzzì˜ í”„ë¡œí† íƒ€ì… êµ¬í˜„ ë° ìµœì‹  í¼ì§• ë„êµ¬ì™€ ë¹„êµ
    - 20ê°œ IoT ì¥ì¹˜ ì¤‘ 5ê°œì˜ ì¥ì¹˜ì—ì„œ null í¬ì¸í„° ì˜ˆì™¸, ì„œë¹„ìŠ¤ ê±°ë¶€ ë° ì•Œ ìˆ˜ ì—†ëŠ” ì¶©ëŒì„ í¬í•¨í•˜ì—¬ 5ê°œì˜ ì œë¡œë°ì´ ì·¨ì•½ì ì„ ë°œê²¬
        - ê·¸ ì¤‘ 3ê°œëŠ” snipuzzì—ì„œë§Œ ë…¸ì¶œ

## Background

---

ëŒ€ë¶€ë¶„ì˜ IoT ì¥ì¹˜ëŠ” ìœ ì‚¬í•œ High-level í†µì‹  ì•„í‚¤í…ì²˜ë¥¼ êµ¬í˜„í•¨

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/9f15fdbb-4415-4cdf-8f7a-a9fecd39a926/74b1fa00-14aa-4470-b22c-a065e84ff2aa/Untitled.png)

1) Sanitizer : ì™¸ë¶€ ì…ë ¥ì„ ìˆ˜ì‹  ì‹œ, êµ¬ë¬¸ ë¶„ì„ ë° Regular Matching ìˆ˜í–‰

2) Function Switch: ì…ë ¥ì—ì„œ ì¶”ì¶œëœ ì†ì„± í‚¤ ë° í•´ë‹¹ ê°’ì— ë”°ë¼ í•´ë‹¹ Functionìœ¼ë¡œ ì œì–´ë¥¼ ì „ì†¡

3) Function Definitions: ê° íŒì›¨ì–´ë§ˆë‹¤ ì •ì˜ëœ ê¸°ëŠ¥ë“¤

4) Replier: í´ë¼ì´ì–¸íŠ¸ì— ì‘ë‹µì„ ë³´ë‚´ëŠ” ì—­í• 

## Motivation

---

### **Response-Based Feedback Mechanism**

- ë„¤íŠ¸ì›Œí¬ ê¸°ë°˜ IoT FuzzerëŠ” ì¥ì¹˜ì˜ ì‹¤í–‰ ìƒíƒœë¥¼ ì§ì ‘ ì–»ì„ ìˆ˜ ì—†ìœ¼ë©° feedback mechanismì„ ì„¤ì •í•˜ê¸° ì–´ë ¤ì›€
    
    â†’ ì…ë ¥ ë©”ì‹œì§€ì— ëŒ€í•œ ì‘ë‹µ ë©”ì‹œì§€ë¥¼ í”¼ë“œë°± ë©”ì»¤ë‹ˆì¦˜ìœ¼ë¡œ ì‚¬ìš©
    
    - íŒì›¨ì–´ì—ì„œ ë°˜í™˜ëœ ì‘ë‹µ ë©”ì‹œì§€ì˜ ë‚´ìš©ì„ í†µí•´ **íŒì›¨ì–´ì—ì„œ ì‹¤í–‰ëœ ì½”ë“œ ë¸”ë¡ì„ ìœ ì¶”**í•  ìˆ˜ ìˆìŒ
    - íŒì›¨ì–´ëŠ” ë‹¤ë¥¸ functionì„ ì‹¤í–‰í•˜ë”ë¼ë„ ë™ì¼í•œ ì‘ë‹µ ë©”ì‹œì§€ë¥¼ ë°˜í™˜í•  ìˆ˜ ìˆìŒ
    - **ì„œë¡œ ë‹¤ë¥¸ ë‘ ì…ë ¥ì´ ì„œë¡œ ë‹¤ë¥¸ ì‘ë‹µ ë©”ì‹œì§€ë¥¼ ë°›ìœ¼ë©´, ì„œë¡œ ë‹¤ë¥¸ íŒì›¨ì–´ ì½”ë“œ ì‹¤í–‰ ê²½ë¡œë¡œ ê°€ëŠ” ê²ƒìœ¼ë¡œ ì¶”ë¡ í•  ìˆ˜ ìˆìŒ**

### Message Snippet Inference

- ëŒ€ë¶€ë¶„ì˜ IoT ì¥ì¹˜ëŠ” ì…ë ¥ êµ¬ë¬¸ì´ ë‹¤ì–‘í•˜ê³  ë¹„í‘œì¤€ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ê°€ ë§ìŒ
- Grammar-Based Mutation ì „ëµì„ ìœ„í•œ í†µì‹  í˜•ì‹ì„ ëŒ€ê·œëª¨ë¡œ ë‹¤ë£¨ëŠ” Train Datasetì„ êµ¬ì¶•í•˜ëŠ” ê²ƒì€ ì–´ë ¤ì›€
    
    â†’ Message Snippetì„ ì¶”ë¡ í•¨
    
    - ìœ íš¨í•œ ë©”ì‹œì§€ë¥¼ ë°”ì´íŠ¸ ë‹¨ìœ„ë¡œ ë³€ê²½í•˜ë©° ë‹¤ì–‘í•œ ì‘ë‹µì„ ìˆ˜ì§‘í•¨
    - **ë™ì¼í•œ ì‘ë‹µì„ ê°€ì§„ ì—°ì† ë°”ì´íŠ¸ë¥¼ í•˜ë‚˜ì˜ Snippetìœ¼ë¡œ ë³‘í•©í•  ìˆ˜ ìˆìŒ**
    

## Methodology

---

SNIPUZZëŠ” IoT ì¥ì¹˜ì—ì„œ íŠ¹ì • ì‘ì—…ì„ ìš”ì²­í•˜ê¸° ìœ„í•´ Message Sequence Mì„ ë³´ë‚´ëŠ” í´ë¼ì´ì–¸íŠ¸ ì—­í• ì„

- ëª¨ë“  ë©”ì‹œì§€ëŠ” IoT ì¥ì¹˜ì— íŠ¹ì • ê¸°ëŠ¥ì´ë‚˜ ì‘ì—…ì„ ìš”ì²­í•¨

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/9f15fdbb-4415-4cdf-8f7a-a9fecd39a926/43c0cbff-b493-4432-bf94-69f017358cf9/Untitled.png)

### Message Sequence Acquisition(ë©”ì‹œì§€ ì‹œí€€ìŠ¤ íšë“)

ì´ˆê¸° Seedë“¤ì˜ í’ˆì§ˆì€ Fuzzing ê²°ê³¼ì— ìƒë‹¹í•œ ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, Highly-Structured Formatsì„ ì¤€ìˆ˜í•˜ëŠ” High-Quality ì´ˆê¸° Seedë¥¼ ì–»ì–´ì•¼ í•¨

Wiresharkë¥¼ ì‚¬ìš©í•˜ì—¬ APIì™€ IoT ì¥ì¹˜ ê°„ì˜ í†µì‹  íŒ¨í‚·ì„ ê°ì§€ ë° ê¸°ë¡

### **1) Initial Seed íšë“**

- í†µì‹  íŒ¨í‚·ì˜ ëŒ€ë¶€ë¶„ êµ¬ì¡° ì •ë³´ ë° í”„ë¡œí† ì½œì€ API í”„ë¡œê·¸ë¨ì—ì„œ Message Payloadë¡œ ì •ì˜ë¨
    - êµ¬ì¡° ì •ë³´ : Header, Message Contents ..
    - í”„ë¡œí† ì½œ : HTTP, MQTT ..
- Target IoT ì¥ì¹˜ì™€ í†µì‹ í•˜ëŠ” ë™ì‹œì— Message Sequenceë¥¼ ì´ˆê¸° Seedë¡œ ì¶”ì¶œí•¨
    - ì˜ˆì‹œ) API í”„ë¡œê·¸ë¨ì„ ì‚¬ìš©í•˜ì—¬ ì „êµ¬ë¥¼ í‚¤ê³  ëŒ ë•Œ,
    
    ![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/9f15fdbb-4415-4cdf-8f7a-a9fecd39a926/82542920-5550-47cd-8ca4-904d1e152d42/Untitled.png)
    

### 2) Restoring Message Sequence Acquisition(ë©”ì‹œì§€ ì‹œí€€ìŠ¤ íšë“ ë³µì›)

- IoT ì¥ì¹˜ì˜ Crash ë¶„ë¥˜ë¥¼ ìœ„í•œ Test Caseë¥¼ ì¬ì—°í•˜ê¸° ìœ„í•´ í…ŒìŠ¤íŠ¸ ì¤‘ì¸ ì¥ì¹˜ê°€ ê° Test Roundì—ì„œ ë™ì¼í•œ ì´ˆê¸° Stateë¥¼ ê°€ì§€ë„ë¡ í•¨
- ì¥ì¹˜ì—ì„œ Message Sequence ë¥¼ ì „ì†¡í•œ í›„, ì¥ì¹˜ë¥¼ ì‚¬ì „ ì •ì˜ëœ ìƒíƒœë¡œ ì¬ì„¤ì •í•˜ê¸° ìœ„í•´ Restoring Message Sequenceë¥¼ ì „ì†¡í•¨

### 3) Manual Efforts

- IP ì£¼ì†Œ ë° ë¡œê·¸ì¸ ì •ë³´ ì„¤ì •ê³¼ ê°™ì€ Test Suites ì—ì„œ í”„ë¡œê·¸ë¨ì„ ìˆ˜ë™ìœ¼ë¡œ êµ¬ì„±í•¨(IoT ì¥ì¹˜ë‹¹ í•œë²ˆë§Œ êµ¬ì„±)
- Message Sequenceë¥¼ ë™ì ìœ¼ë¡œ ìº¡ì³í•˜ê¸° ìœ„í•´ Network Traffice Monitorì—ì„œ íŠ¹ì • í˜•ì‹ê³¼ í”„ë¡œí† ì½œì„ ìˆ˜ë™ìœ¼ë¡œ ì •ì˜
- Fuzzing Processë¥¼ ì˜ëª» ì´ëŒ ì¼ë¶€ Message Sequenceë¥¼ í•„í„°ë§
    - ì˜ˆì‹œ ) ì¼ë¶€ API í”„ë¡œê·¸ë¨ì€ ì¥ì¹˜ë¥¼ ìë™ ì—…ë°ì´íŠ¸í•˜ê±°ë‚˜ ë‹¤ì‹œ ì‹œì‘í•  ìˆ˜ ìˆëŠ” ì‘ì—…ì„ ì œê³µ
        - ì´ì™€ ê°™ì€ ì‘ì—…ì€ ì¥ì¹˜ë¥¼ ì¤‘ì§€í•˜ë¯€ë¡œ ì‘ë‹µì´ ì „ì†¡ë˜ì§€ ì•ŠìŒ
        - ë¬´ì‘ë‹µ ì‹¤í–‰ì„ ì¶©ëŒë¡œ ê°„ì£¼í•˜ê¸° ë•Œë¬¸ì— false-positive ì¶©ëŒì´ ë°œìƒ
- Manual workëŠ” ì¥ì¹˜ë‹¹ ì•½ 5ëª…ì´ë©°, Snipuzzì˜ message sequence acquisition ë‹¨ê³„ì—ì„œë§Œ í•„ìš”
- IoT ì¥ì¹˜ì˜ ë¬¼ë¦¬ì  ì¬ì‹œì‘ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ê¸° ìœ„í•´ ìŠ¤ë§ˆíŠ¸ í”ŒëŸ¬ê·¸ ì‚¬ìš©

### Snippet Determination

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/9f15fdbb-4415-4cdf-8f7a-a9fecd39a926/62970bb1-f000-4a65-ba3b-e6b639311f66/Untitled.png)

 

### 1) Initial Determination

- Seed Corpusì— ì†í•˜ëŠ” ê° messageì— ëŒ€í•œ probe message ìƒì„± í›„, IoT ì¥ì¹˜ì— ì „ì†¡(response messages ìˆ˜ì§‘)
    - "Probe message " $ğ‘_ğ‘–$ ": " ğ‘€ğ‘’ğ‘ ğ‘ ğ‘ğ‘”ğ‘’ ğ‘š"ì—"ì„œ íŠ¹ì • ë°”ì´íŠ¸ë¥¼ ì‚­ì œí•˜ì—¬ ìƒì„±í•˜ëŠ” ê²ƒ
- Heuristic algorithmì„ ì‚¬ìš©í•˜ì—¬ ê° ë©”ì‹œì§€ì˜ response messagesë¥¼ ëŒ€ëµì  initial snippetìœ¼ë¡œ ë‚˜ëˆ”
    - ê° Probe messagesì˜ response messagesë¥¼ ë¶„ë¥˜í•˜ì—¬ message snippetì„ ê²°ì •

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/9f15fdbb-4415-4cdf-8f7a-a9fecd39a926/580cbef3-57fb-459b-9948-7b6b34bc9019/Untitled.png)

- Response messageì— íƒ€ì„ìŠ¤íƒ¬í”„/í† í° ë“±(Randomness)ì´ í¬í•¨ë  ê²½ìš°, ì˜ë¯¸ìƒ ë™ì¼í•œ Response messagesê°€ ë‹¤ë¥¸ ì¹´í…Œê³ ë¦¬ë¡œ ë¶„ë¥˜ë¨
- Response categoryë¥¼ ê²°ì •í•˜ê¸° ìœ„í•´ ë¬¸ìì—´ì˜ ìœ ì‚¬ì„±ì„ ê³„ì‚°í•˜ëŠ” Edit Distance(Similarity score) ì‚¬ìš©
    - $If (ğ‘†_ğ‘–ğ‘˜ >= ğ‘†_ğ‘–ğ‘–) or (ğ‘†_ğ‘–ğ‘˜ >= ğ‘†_ğ‘˜ğ‘˜)$ "satisfies, responses " $ğ‘Ÿ_ğ‘–$ " and " $ğ‘Ÿ_ğ‘˜$  "will be considered belonging to the same category".
    - $Self-similarity(ğ‘†_ğ‘–ğ‘–)$: "1" ì´ˆ ê°„ê²©ìœ¼ë¡œ ğ‘_ğ‘–ë¥¼ ë‘ ë²ˆ ì „ì†¡, response message($ğ‘Ÿ_ğ‘–,  ğ‘Ÿ_ğ‘–^â€²$) ëŒ€ìƒìœ¼ë¡œ Similarity score ê³„ì‚°
- ìƒˆë¡œìš´ response message(ğ‘Ÿ_ğ‘–)ì— ëŒ€í•´ Response Poolì˜ ëª¨ë“  response messageì™€ì˜ Similarity scoreë¥¼ ë¹„êµ
    - $ğ‘Ÿ_ğ‘–$ ì´ ê¸°ì¡´ categoryì— ì†í•˜ì§€ ì•ŠëŠ” ê²½ìš°, $(ğ‘_ğ‘–,  ğ‘Ÿ_ğ‘–)$ê°€ Response Poolì— ì¶”ê°€

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/9f15fdbb-4415-4cdf-8f7a-a9fecd39a926/c8243f5f-6dfb-4c47-aba5-a00957b33929/Untitled.png)

1. {"error":{"type":2, "address":"/lights/1/state", "timestamp":23032**9**", "descriptions":"body contains invalid json"}} 
2. {"error":{"type":2, "address":"/lights/1/state", "timestamp":23032**8**", "descriptions":"body contains invalid json"}}
    
    -----------------------------------------------------------------------------------------------------------------------------
    
    â€œtimestampâ€ ê°’ì˜ ë§ˆì§€ë§‰ ìë¦¬ë§Œ ë‹¤ë¦„( 9â†’8 êµì²´)
    
    **edit_distance(1, 2) = 1**
    

### 2) H**ierarchical Clustering**

- Similarity scoreë¥¼ ì´ìš©í•˜ì—¬ randomness of responsesë¥¼ ì™„í™”í•˜ì§€ë§Œ, responsesëŠ” ì—¬ì „íˆ ë‹¤ë¥¸ ë²”ì£¼ë¡œ ì˜ëª» ë²”ì£¼í™” ë  ìˆ˜ ìˆìŒ
    - Response messagesì— probe messageì—ì„œ ì¶”ì¶œë˜ê±°ë‚˜ ë³µì‚¬ëœ ë‚´ìš©ì´ í¬í•¨ëœ ê²½ìš° ë°œìƒ
- Agglomerative hierarchical clusters ì‚¬ìš©
    - í•˜ë‚˜ì˜ í´ëŸ¬ìŠ¤í„°ë§Œ ë‚¨ì„ ë•Œê¹Œì§€ ê°€ì¥ ìœ ì‚¬í•œ í´ëŸ¬ìŠ¤í„°ë¥¼ ê³„ì† ë³‘í•©(bottom-up ë°©ì‹)
    - Vector: (self-similarity score, length of the response, number of alphabetic segments, number of numeric segments, number of symbol segments)
        
        ![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/9f15fdbb-4415-4cdf-8f7a-a9fecd39a926/c689df8c-87f7-4cbe-ab49-ab9ab849e5bd/Untitled.png)
        

### Mutation

Snippet Mutation

- ë©”ì‹œì§€ì˜ ë‹¨ì¼ ë°”ì´íŠ¸ ëŒ€ì‹  ì „ì²´ Snippetì—ì„œ Mutation Schemes ìˆ˜í–‰
- **Mutation Schemes**
    - **Empty**
    The empty of a data domain may crash the firmware if the data domain is not properly checked.
    Delete an entire snippet to empty the data domain.
    - **Byte Flip**
    To detect bugs in both the syntax parsers and the functional code, Snipuzz flips all bytes in a snippet.
    Byte Flip changes the values of data domains to examine firmware.
    - **Data Boundary**
    To detect the out-of-bound bugs that occur during assignment, Snipuzz modifies the values of numeric data to some boundary values.
    - **Dictionary**
    For the scheme of Dictionary, Snipuzz replaces a snippet with a pre-defined string such as â€œtrueâ€ and â€œfalseâ€, which may directly explore more code coverage.
    - **Repeat**
    In order to detect bugs in syntax parsers, Snipuzz repeats a snippet for multiple times.
    The repetition of data domain can detect defects caused by out-of-boundary problems.
    - **Havoc**
        - ë²„ê·¸ë¥¼ ìœ ë°œí•˜ê¸° ìœ„í•´ ë™ì¼í•œ ë©”ì‹œì§€ì—ì„œ ë‹¤ë¥¸ ë°ì´í„° ë„ë©”ì¸ì„ ìˆ˜ì •í•´ì•¼ í•  ìˆ˜ ìˆìŒ
        - ë©”ì‹œì§€ì—ì„œ ì„ì˜ì˜ snippetì„ ì„ì˜ë¡œ ì„ íƒí•˜ê³  ì„ íƒí•œ snippet ê°ê°ì— ëŒ€í•´ mutation schemes ìˆ˜í–‰
        - Havoc mutationì€ ìƒˆë¡œìš´ response categoryë¥¼ ì°¾ê±°ë‚˜ ëŒ€ìƒ IoT ì¥ì¹˜ê°€ ì¶©ëŒí•  ë•Œê¹Œì§€ ë©ˆì¶”ì§€ ì•ŠìŒ
        

### Network Traffic Monitor

Network Communication MonitoringëŠ” ì¥ì¹˜ì— ì „ì†¡ëœ ëª¨ë“  ë©”ì‹œì§€ë¥¼ ê¸°ë¡, ì¥ì¹˜ê°€ ì‘ë‹µí•˜ì§€ ì•Šì„ ë•Œ ì¥ì¹˜ì— ë©”ì‹œì§€ ì¬ì „ì†¡

- Input Messageë¡œ ì¸í•´ IoT ì¥ì¹˜ê°€ ì¶©ëŒí–ˆëŠ”ì§€ ì—¬ë¶€ë¥¼ ê²°ì •í•˜ê¸° ìœ„í•´ **TimeOut**ì„ ì„¤ì •í•¨
    - ë™ì¼í•œ Message Sequenceë¥¼ 3ë²ˆ ì—°ì† ì „ì†¡
        - TimeOutì˜ ì›ì¸ì´ ì¥ì¹˜ ì¶©ëŒì´ ì•„ë‹Œ, ë„¤íŠ¸ì›Œí¬ ë³€ë™ì¼ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— 3ë²ˆ ì—°ì† ì „ì†¡í•¨
        - ë‹¤ì‹œ TimeOut ë°œìƒ ì‹œ, IoT ì¥ì¹˜ì˜ ì¶©ëŒë¡œ ê°„ì£¼í•˜ë©°, í•´ë‹¹ Message Sequenceë¡œ ê¸°ë¡í•¨
    
    ![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/9f15fdbb-4415-4cdf-8f7a-a9fecd39a926/5d37684f-efe3-4354-999d-4916aade0cae/Untitled.png)
    

## Experimental Evaluation

---

### ì‹¤í—˜ Setup

- IoT ì¥ì¹˜ë¥¼ ì´ˆê¸°í™”í•˜ê¸° ìœ„í•´ ì œì¡°ì—…ì²´ì—ì„œ ì œê³µí•˜ëŠ” ì‘ìš©í”„ë¡œê·¸ë¨ì„ ì‚¬ìš©í•˜ì—¬ í˜ì–´ë§
- ë„¤íŠ¸ì›Œí¬ í†µì‹ ì„ ëª¨ë‹ˆí„°ë§í•˜ê¸° ìœ„í•´ í…ŒìŠ¤íŠ¸ ì¤‘ì¸ ëª¨ë“  ì¥ì¹˜ëŠ” ë¡œì»¬ ë¼ìš°í„°ì— ì—°ê²°
    - PC: Â Intel Core i7 six-core x 3.70 GHz CPU, 16GB RAM
- IoT Devices
    - Philips, Xiaomi, TP-Link ë° Netgearì™€ ê°™ì€ ë‹¤ì–‘í•œ ìœ ëª… ë¸Œëœë“œ í¬í•¨í•˜ì—¬ ì „ì„¸ê³„ ë² ìŠ¤íŠ¸ì…€ëŸ¬ 20ê°œ IoT ì¥ì¹˜ ì„ íƒ
- Benchmark tools
    - ì¶©ëŒ ë° ë©”ì‹œì§€ ë¶„í• ì„ ì°¾ëŠ” Snipuzzì˜ ì„±ëŠ¥ í™•ì¸ì„ ìœ„í•´ 7ê°€ì§€ í¼ì§• ë°©ë²•ë¡ ì„ ì‚¬ìš©
        - IoTFuzzer(NDSS, 2018): applicationì— ëŒ€í•œ ì •ì ë¶„ì„, íŠ¹ì • ë³€ìˆ˜ì˜ ê°’ì„ mutation
        - Nemesys(Usenix, 2018): ë„¤íŠ¸ì›Œí¬ ë©”ì‹œì§€ ë¶„ì„ì„ ìœ„í•œ í”„ë¡œí† ì½œ ë¦¬ë²„ìŠ¤ ì—”ì§€ë‹ˆì–´ë§ ë„êµ¬, ë°ì´í„° ë„ë©”ì¸ì˜ ê²½ê³„ ê°’ ì¶”ë¡ 
        - [BooFuzz](https://github.com/jtpereyda/boofuzz/tree/dbe720a425d8ade45accad317d8e4f0c66912ae3)-Default, Byte, Reversal: ë„¤íŠ¸ì›Œí¬ í”„ë¡œí† ì½œ, human-guided message segment strategy
        - [Doona](https://github.com/wireghoul/doona): ë„¤íŠ¸ì›Œí¬ í”„ë¡œí† ì½œì˜ ë²„í¼ ë° í˜•ì‹ê³¼ ê´€ë ¨ëœ ì·¨ì•½ì  íƒì§€ ë„êµ¬, íŒ¨í‚·ì„ seedë¡œ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ, í…ŒìŠ¤íŠ¸ì¼€ì´ìŠ¤ëŠ” ê° ì¥ì¹˜/í”„ë¡œí† ì½œì— ëŒ€í•´ ë¯¸ë¦¬ ì •ì˜ë˜ì–´ì•¼ í•¨
        - Snipuzz-NoSnippet: Snippet determination component ì—†ì´ ë©”ì‹œì§€ì˜ byte mutation

### ì‹¤í—˜ ê²°ê³¼

- **SNIPUZZì—ì„œ 5ê°œì˜ IoT ì¥ì¹˜ì—ì„œ 13ê°œì˜ ì¶©ëŒ ê°ì§€**
    
    ![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/9f15fdbb-4415-4cdf-8f7a-a9fecd39a926/cd6355a3-516e-4aed-a55d-02be50efcf9c/Untitled.png)
    

- **ì·¨ì•½ì  ì‹ë³„**
    
    **1) Null pointer dereferences**
    
    - Messageì— ëŒ€í•œ response messages ì—†ì´ ëª‡ ë¶„ í›„ ì¥ì¹˜ê°€ ìë™ìœ¼ë¡œ ë‹¤ì‹œ ì‹œì‘ë˜ê³  initial stateë¡œ ë³µêµ¬ë¨
    - í•´ë‹¹ ì·¨ì•½ì ì´ ë°œê²¬ëœ IoT ì¥ë¹„ ëª¨ë‘ JSON êµ¬ë¬¸ìœ¼ë¡œ mutation messageì— ì˜í•´ íŠ¸ë¦¬ê±°ë¨
        - ì¤‘ê´„í˜¸ ë° ì½œë¡ ê³¼ ê°™ì€ ì¼ë¶€ í˜•ì‹ ë˜ëŠ” messageì˜ ì¼ë¶€ê°€ ë³€ê²½ë˜ë©´ ë©”ì‹œì§€ì˜ êµ¬ë¬¸ êµ¬ì¡° ë° ì˜ë¯¸ê°€ ì†ìƒë¨
    
    **2) Denial of service**
    
    - Philipsì˜ ê³µì‹ applicationì€ IoT ê¸°ê¸°ë¥¼ ì •ìƒì ìœ¼ë¡œ ê´€ë¦¬í•˜ì§€ ëª»í•¨
        - Appì—ì„œ ì¥ì¹˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìœ¼ë©° ì¶”ê°€ ë©”ì‹œì§€ì— ëŒ€í•œ responseì€ í•´ë‹¹ ì¥ì¹˜ë¥¼ ì¥ì¹˜ ê·¸ë£¹ì— ë°”ì¸ë”©í•˜ë„ë¡ ìš”ì²­í•˜ê³  ë” ì´ìƒ ìƒí˜¸ì‘ìš© ë¶ˆê°€ëŠ¥
        - ê·¸ëŸ¬ë‚˜ ë©”ì‹œì§€ íŒ¨í‚·ì´ í•´ë‹¹ ì¥ì¹˜ë¡œ ì§ì ‘ ì „ì†¡ë˜ë©´ ì¥ì¹˜ê°€ ì •ìƒì ìœ¼ë¡œ ì‘ë™
            
            â†’ IoT ì¥ì¹˜ê°€ ì™„ì „íˆ ì¶©ëŒí•˜ì§„ ì•Šì§€ë§Œ applicationì„ í†µí•œ ì„œë¹„ìŠ¤ê°€ ê±°ë¶€ë¨
            
    
    **3) Unknown crashes**
    
    - IoT ì¥ì¹˜ê°€ ì¶©ëŒí•œ ë‹¤ìŒ ì•½ 1ë¶„ ì´ë‚´ì— ìì²´ì ìœ¼ë¡œ ë‹¤ì‹œ ì‹œì‘ë¨
    - ì¶©ëŒì´ ë§¤ê°œë³€ìˆ˜ ë¬´íš¨í™”ì™€ ê°™ì€ íŠ¹ì • ë°ì´í„° ë„ë©”ì¸ì˜ ì‚­ì œë¡œ ì¸í•œ ê²ƒì„ì„ ë°œê²¬
        - ê·¸ëŸ¬ë‚˜ íŒì›¨ì–´ê°€ ê³µê°œë˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— ê·¼ë³¸ ì›ì¸ì„ í™•ì¸í•  ìˆ˜ ì—†ìŒ
        - êµ¬ë¬¸ ë¶„ì„ í”„ë¡œì„¸ìŠ¤ ì¤‘ì— null ê°’ì„ ì½ëŠ” ì¥ì¹˜ë¡œ ì¸í•´ í• ë‹¹ ì¤‘ ì¶©ëŒì´ ë°œìƒí•œ ê²ƒìœ¼ë¡œ ì¶”ë¡ 
            - ë¡œì»¬ ë„¤íŠ¸ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ëŠ” í†µì‹ ì—ëŠ” ì¸ì¦ì´ í•„ìš”í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ë¡œì»¬ ë„¤íŠ¸ì›Œí¬ì˜ ê³µê²©ìê°€ ì¥ì¹˜ë¥¼ ì†ìƒì‹œí‚¬ ìˆ˜ ìˆìŒ
                
                â†’ ë”°ë¼ì„œ í•´ë‹¹ ì·¨ì•½ì ì„ ì›ê²© ì•…ìš© ê°€ëŠ¥ ì·¨ì•½ì ìœ¼ë¡œ ê°„ì£¼í•¨
                

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/9f15fdbb-4415-4cdf-8f7a-a9fecd39a926/28e2a300-5434-45e5-b9eb-e82209c48ce5/Untitled.png)

- **ì‹¤í–‰ì‹œê°„ ì„±ëŠ¥**
    
    Snipuzz ë° ë‹¤ë¥¸ 7ê°œ Benchmark Fuzzerê°€ ì²˜ìŒ 10ë¶„ ë™ì•ˆ íŒì›¨ì–´ë¥¼ íƒìƒ‰í•˜ì—¬ response category ë¶„ë¥˜ ê²°ê³¼
    
    ![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/9f15fdbb-4415-4cdf-8f7a-a9fecd39a926/f2d95ee8-136f-466c-a7e0-8078cce93c4b/Untitled.png)
    

## Discussion And Limitation

---

### **Scalability and manual effort**

- Manual worksëŠ” ê³µê°œì ìœ¼ë¡œ ì‚¬ìš©ê°€ëŠ¥í•œ first/third party resourcesì—ì„œ ì–»ì€ API í”„ë¡œê·¸ë¨ì˜ íŒ¨í‚·ì„ ì •ë¦¬í•˜ëŠ”ë° ì¤‘ì 
- Snipuzzë¥¼ ì ìš©í•  ë•Œ, IoT ì¥ì¹˜ì— í¬ë¡¤ëŸ¬ì™€ ê°™ì€ ê¸°ìˆ ì„ ì‚¬ìš©í•˜ì—¬ API í”„ë¡œê·¸ë¨ì„ ìë™ìœ¼ë¡œ ìˆ˜ì§‘ ê°€ëŠ¥, ìŠ¤í¬ë¦½íŠ¸ë¥¼ í†µí•´ í‚¤ì›Œë“œë¥¼ ì „ì²˜ë¦¬í•˜ì—¬ packet cleaning processë¥¼ ê°œì„ í•˜ì—¬ í†µì‹  íŒ¨í‚¤ì§€ë¥¼ ìë™ìœ¼ë¡œ ìˆ˜ì§‘ ê°€ëŠ¥

### **Threats to validity**

- 1) API í”„ë¡œê·¸ë¨ ë¶€ì¬í•  ë•Œ
- 2) ë©”ì‹œì§€ì˜ ì•”í˜¸í™”
- 3) APIí”„ë¡œê·¸ë¨ì—ì„œ ë‹¤ë£¨ëŠ” ê¸°ëŠ¥ë§Œ ê²€ì‚¬ ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— íŒì›¨ì–´ì˜ ì½”ë“œ ì ìš© ë²”ìœ„ëŠ” API í”„ë¡œê·¸ë¨ì˜ ì•¡ì„¸ìŠ¤ì— ë”°ë¼ ë‹¬ë¼ì§
    - ì˜ˆì‹œ) ì „êµ¬ì˜ API í”„ë¡œê·¸ë¨ì´ ì „ì›ì„ ì¼œëŠ” ê¸°ëŠ¥ë§Œ ì§€ì›í•œë‹¤ë©´ ì „ì›ì´ ì¼œì§„ ìƒíƒœì—ì„œ ìº¡ì²˜í•œ ë©”ì‹œì§€ë¥¼ mutate í•˜ì—¬ ë°ê¸° ì¡°ì ˆí•˜ëŠ” ê²ƒì€ ë¶ˆê°€ëŠ¥

### **Requirements on detailed responses**

- Snipuzzì˜ íƒì§€ íš¨ê³¼ëŠ” IoT ì¥ì¹˜ì˜ response messageì—ì„œ ì–¼ë§ˆë‚˜ ë§ì€ ì •ë³´ë¥¼ ì–»ì„ ìˆ˜ ìˆì„ ì§€ì— ë”°ë¼ message snippetì˜ í’ˆì§ˆì´ ë‹¬ë¼ì§
    - IoT ì¥ì¹˜ê°€ ê· ì¼í•œ ë©”ì‹œì§€ë¡œ ëª¨ë“  ì˜¤ë¥˜ë¥¼ ë³´ê³ í•˜ì§€ ì•Šìœ¼ë©´, message snippetì„ ê²°ì •í•˜ê¸° ì–´ë ¤ìš¸ ìˆ˜ ìˆìŒ
- ë§ì€ IoT ì¥ì¹˜ì—ì„œ ë””ë²„ê·¸ ëª¨ë“œì—ì„œ advanced error descriptionsì„ ì–»ì„ ìˆ˜ ìˆì–´ snipuzzì˜ message snippet determination processë¥¼ ê°œì„ í•  ìˆ˜ ìˆì—ˆìŒ

## Conclusion

---

- ë³¸ ë…¼ë¬¸ì—ì„  IoT ì¥ì¹˜ì— ìˆ¨ì–´ìˆëŠ” ì·¨ì•½ì ì„ íƒì§€í•˜ê¸° ìœ„í•´ ì„¤ê³„ëœ ë¸”ë™ë°•ìŠ¤ Fuzzing í”„ë ˆì„ì›Œí¬ Snipuzzë¥¼ ì œì•ˆ
- ë‹¤ë¥¸ ë¸”ë™ë°•ìŠ¤ ë„¤íŠ¸ì›Œí¬ Fuzz í…ŒìŠ¤íŠ¸ì™€ ë‹¬ë¦¬ SnipuzzëŠ” ì¥ì¹˜ì—ì„œ ë°˜í™˜ëœ response messageë¥¼ ì‚¬ìš©í•˜ì—¬ Fuzzing mutation processë¥¼ ë³´ì•ˆí•˜ëŠ” feedback mechanismì„ ì„¤ì •
- ì¥ì¹˜ì˜ responseì„ ê¸°ë°˜ìœ¼ë¡œ ë©”ì‹œì§€ì˜ ê° ë°”ì´íŠ¸ì˜ ë¬¸ë²•ì  ì—­í• ì„ ì¶”ë¡ í•˜ë¯€ë¡œ ë¬¸ë²• ê·œì¹™ì˜ ì‚¬ì „ ì •ë³´ ì—†ì´ ì¥ì¹˜ì˜ ë¬¸ë²•ì„ ì¶©ì¡±í•˜ëŠ” í…ŒìŠ¤íŠ¸ ì‚¬ë¡€ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŒ
- Snipuzzë¥¼ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ 20ê°œì˜ ì†Œë¹„ì ë“±ê¸‰ IoT ì¥ì¹˜ë¥¼ ì‚¬ìš©í•˜ì—¬ 5ê°œì˜ ì„œë¡œ ë‹¤ë¥¸ ì¥ì¹˜ì—ì„œ 5ê°œì˜ zero-day ì·¨ì•½ì ì„ ë°œê²¬í•¨
